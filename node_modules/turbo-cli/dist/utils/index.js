var fs=require("fs"),Promise=require("bluebird"),superagent=require("superagent"),dotenv=require("dotenv"),MODE_0666=parseInt("0666",8);module.exports={isTurboApp:function(){var e=null,n=null;try{e=fs.readFileSync("package.json","utf8");var r=JSON.parse(e),i=r.dependencies;if(null==i.turbo360||null==i.vertex360)return{isTurboApp:!1,missing:"turbo360 and/or vertex 360",reason:"Missing turbo360 and/or vertex 360 dependencies"};var o=fs.readFileSync(".env","utf8");n=dotenv.parse(o);var t=n.TURBO_ENV;return null==t?{isTurboApp:!1,missing:"TURBO_ENV environment variable",reason:'Missing TURBO_ENV environment variable. Please set "TURBO_ENV=dev" in the .env file'}:{isTurboApp:!0,turboEnv:t,turbo360:i.turbo360,vertex360:i.vertex360}}catch(n){var s=null==e?"package.json":".env",u=null==e?"Missing package.json file":'Missing .env file. Please add .env file with "TURBO_ENV=dev" variable set.';return{isTurboApp:!1,missing:s,reason:u}}},validateEnv:function(e,n){var r=null;return n.forEach(function(n){var i=n.text;return null==e[i]?void(r=i):e[i]==n.placeholder?void(r=i):e[i].length<n.min?void(r=i):void 0}),r},write:function(e,n,r){fs.writeFileSync(e,n,{mode:r||MODE_0666})},readFile:function(e,n){return new Promise(function(r,i){fs.readFile(e,"utf8",function(e,o){if(e){var t=n?Error(n):e;return void i(t)}r(o)})})},postRequest:function(e,n){return new Promise(function(r,i){superagent.post(e).send(n).set("Accept","application/json").end(function(e,n){return e?void i(e):"success"!=n.body.confirmation?void i(new Error(n.body.message)):void r(n.body)})})},putRequest:function(e,n){return new Promise(function(r,i){superagent.put(e).send(n).set("Accept","application/json").end(function(e,n){return e?void i(e):"success"!=n.body.confirmation?void i(new Error(n.body.message)):void r(n.body)})})},getRequest:function(e){return new Promise(function(n,r){superagent.get(e).set("Accept","application/json").end(function(e,i){return e?void r(e):"success"!=i.body.confirmation?void r(new Error(i.body.message)):void n(i.body)})})}};